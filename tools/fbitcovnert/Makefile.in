CC      = @CC@
CFLAGS  = @CFLAGS@
LIBS    = @LIBS@
INCLUDE = "-I../../../"
TOPDIR = @CONFIGURE_PWD@

XSLTPROC = @XSLTPROC@
XSLTMANSTYLE = @XSLTMANSTYLE@

VERSION = $(shell cut -f1 @CONFIGURE_PWD@/VERSION | tr -d '\n')
NAME = @PACKAGE_NAME@

DIR = "tools/nffile2fastbit"
SRCS = nffile2fastbit.c

all: nffile2fastbit


nffile2fastbit: $(SRCS)
	$(CC) $(CFLAGS) $(LIBS) -o $@ $<

%.1 %.2 %.3 %.4 %.5 %.6 %.7 %.8 %.9: %.dbk
	@if [ -n "$(XSLTPROC)" ]; then \
		if [ -f "$(XSLTMANSTYLE)" ]; then \
			echo $(XSLTPROC) $(XSLTMANSTYLE) $<; \
			$(XSLTPROC) $(XSLTMANSTYLE) $<; \
		else \
			echo "Missing $(XSLTMANSTYLE)!"; \
			exit 1; \
		fi \
	else \
		echo "Missing xsltproc"; \
	fi


clean:
	-rm *.o nffile2fastbit;

.PHONY: tarball-prepare
tarball-prepare:
	@for i in Makefile.in $(SRCS) $(MANSRCS) $(SCRIPTS) $(RCSCRIPTS); do \
		[ -d $(TOPDIR)/$(NAME)-$(VERSION)/$(DIR) ] || \
			mkdir -p $(TOPDIR)/$(NAME)-$(VERSION)/$(DIR) -p; \
		cp $$i $(TOPDIR)/$(NAME)-$(VERSION)/$(DIR)/$$i; \
	done;

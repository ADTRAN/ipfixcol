################################################
# Makefile for the ipfixcol input plugin test  #
################################################

CC      = @CC@
CFLAGS  = @CFLAGS@
LIBS    = @LIBS@
INCLUDE = "-I../../../"

TOPDIR = @CONFIGURE_PWD@
NAME = @PACKAGE_NAME@
RELEASE = @RELEASE@
VERSION = $(shell cut -f1 $(TOPDIR)/VERSION | tr -d '\n')
DIR = "src/input/udp"

SRCS = udp_input.c
OBJ = udp_input.o


all: udp_input.so

udp_input.so: udp_input.o
	$(CC) $(CFLAGS) $(LIBS) -shared -Wl,-soname,udp_input.so.1 -o $@ $< -lc
	
$(OBJ): $(SRCS)
	@for i in $(SRCS); do \
		$(CC) $(CFLAGS) $(INCLUDE) -fPIC -c $$i; \
	done;

clean:
	rm -f udp_input.so udp_input.o

.PHONY: tarball-prepare
tarball-prepare:
	@for i in Makefile.in $(SRCS) $(MANSRCS) $(DOC); do \
		[ -d $(TOPDIR)/$(NAME)-$(VERSION)/$(DIR) ] || \
		mkdir -p $(TOPDIR)/$(NAME)-$(VERSION)/$(DIR) -p; \
		cp $$i $(TOPDIR)/$(NAME)-$(VERSION)/$(DIR)/$$i; \
	done;


